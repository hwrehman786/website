{% extends "layout.html" %}

{% block content %}
<div class="form-container">
    <h2><i class="fas fa-edit"></i> Edit Post</h2>
    <form method="post" enctype="multipart/form-data">
        <!-- Title -->
        <div class="input-group">
            <label>Post Title</label>
            <input type="text" name="title" placeholder="Enter an engaging title for your post..." value="{{ post.title }}" required>
        </div>

        <!-- Content Editor with Preview -->
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;align-items:start">
            <div>
                <div class="input-group">
                    <label><i class="fas fa-keyboard"></i> Write Your Content (Markdown supported)</label>
                    <textarea id="contentEditor" name="content" placeholder="Write your article content here... Markdown is supported!" required>{{ post.content }}</textarea>
                </div>
            </div>
            <div>
                <div class="input-group">
                    <label><i class="fas fa-eye"></i> Live Preview</label>
                    <div id="mdPreview" style="background:rgba(0,212,255,0.05);border:1px solid rgba(0,212,255,0.2);min-height:300px;padding:14px;border-radius:8px;color:var(--text);overflow:auto;line-height:1.6">{{ post.content|md }}</div>
                </div>
            </div>
        </div>

        <!-- Tags -->
        <div class="input-group">
            <label><i class="fas fa-tags"></i> Tags</label>
            <input type="text" name="tags" placeholder="Enter tags separated by commas (e.g. security, tutorial, cybersecurity)" value="{{ post.tags or '' }}">
        </div>

        <!-- Publish Settings -->
        <div class="input-group">
            <label><i class="fas fa-clock"></i> Schedule Publish (Optional)</label>
            <input type="datetime-local" name="publish_at" value="{% if post.publish_at %}{{ post.publish_at.strftime('%Y-%m-%dT%H:%M') }}{% endif %}">
        </div>

        <!-- Image Upload -->
        <div class="input-group">
            <label><i class="fas fa-image"></i> Featured Image</label>
            <div class="file-upload" id="dropZone" style="border:2px dashed rgba(0,212,255,0.3);padding:30px;border-radius:8px;text-align:center;cursor:pointer;transition:all 0.2s;background:rgba(0,212,255,0.02)">
                <label for="image" style="cursor:pointer">
                    <i class="fas fa-cloud-upload-alt" style="font-size:32px;color:var(--primary);margin-bottom:12px;display:block"></i>
                    <p style="margin:0;color:var(--text);font-weight:600">Drag image here or click to replace</p>
                    <p style="margin:6px 0 0 0;color:var(--muted);font-size:12px">Supported formats: PNG, JPG, GIF</p>
                </label>
                <input type="file" id="image" name="image" accept="image/*" style="display:none">
                <div id="imagePreview" style="margin-top:12px"></div>
            </div>
        </div>

        <!-- Submit Button -->
        <button type="submit" class="btn-primary" style="margin-top:20px;padding:14px 24px;font-size:16px">
            <i class="fas fa-check"></i> Save Changes
        </button>
    </form>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</div>
{% endblock %}
